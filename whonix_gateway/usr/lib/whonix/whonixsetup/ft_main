#!/bin/bash

## Debugging
#set -x

error_handler() {
   local MSG="\
###########################################################
## Something went wrong. Please report this bug!
##
## BASH_COMMAND: $BASH_COMMAND
###########################################################\
"
   echo "$MSG"
   exit 1
} 

trap "error_handler" ERR

source /usr/lib/whonix/whonixcheck/10_preparation
get_local_whonix_version

MENU_TITLE="whonixsetup $INSTALLED_WHONIX_VERSION First Time Connection Wizard"

MENU_TEXT="Before we let Tor connect, we need to know about your Internet connection.

Options 2, 3, 4, 5, 6 and 7 are textual help.
Do any of the following apply to you?

Please scroll down using the arrow keys."

exec 3>&1

trap "" ERR

_return=$(\
   dialog \
      --title "$MENU_TITLE" \
      --menu "$MENU_TEXT" \
         100 120 20 \
         "1" "I'm ready to enable Tor." \
         "2" "I want to disable Tor." \
         "3" "Tor is censored and/or dangerous in my area, circumvention, firewall settings." \
         2>&1 1>&3)

EXITCODE=$?

trap "error_handler" ERR

exec 3>&-;

exit $_return
