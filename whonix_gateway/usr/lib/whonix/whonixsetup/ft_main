#!/bin/bash

## Debugging
#set -x

error_handler() {
   local MSG="\
###########################################################
## Something went wrong. Please report this bug!
##
## BASH_COMMAND: $BASH_COMMAND
###########################################################\
"
   echo "$MSG"
   exit 1
} 

trap "error_handler" ERR

source /usr/lib/whonix/whonixcheck/10_preparation
get_local_whonix_version

MENU_TITLE="whonixsetup $INSTALLED_WHONIX_VERSION First Time Connection Wizard"

MENU_TEXT="Before we let Tor connect, we need to know about your Internet connection.

Options 2, 3, 4, 5, 6 and 7 are textual help.
Do any of the following apply to you?

Please scroll down using the arrow keys."

exec 3>&1

trap "" ERR

_return=$(\
   dialog \
      --title "$MENU_TITLE" \
      --menu "$MENU_TEXT" \
         100 120 20 \
         "1" "I'm ready to enable Tor. Connect to the public Tor network now." \
         "2" "Tor is censored in my area." \
         "3" "Using Tor is dangerous in my area." \
         "4" "I want to hide Tor from my internet service provider." \
         "5" "I want to hide Whonix from my internet service provider." \
         "6" "I need a proxy to access the Internet." \
         "7" "My firewall only lets me connect to certain ports." \
         "8" "I want to disable Tor." \
         2>&1 1>&3)

EXITCODE=$?

trap "error_handler" ERR

exec 3>&-;

exit $_return
